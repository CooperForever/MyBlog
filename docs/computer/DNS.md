# DNS 解析地址过程分析
## 什么是DNS
- DNS（Domain Name System) 域名系统，用于TCP/IP网络，提供将主机名和域名转换为ip地址的能力。
- DNS位于网络的应用层。
- DNS服务器一般分为三种，根DNS服务器，顶级DNS服务器，权威DNS服务器。
- DNS使用UDP通讯，速度快
## DNS解析过程
1. 在浏览器中输入 `www.example.com`，系统首先查本地hosts是否有网址映射，如果有直接使用映射地址，完成解析。
2. 如果没有hosts映射，查找本地DNS解析器缓存，如果有直接使用缓存，完成解析。
3. 1、2都不满足情况下，先找TCP/IP参数中设置的首选DNS服务器，该服务器收到查询，如果需要查询的域名包含在本地配置资源中，解析返回给客户端，完成解析，此解析具有权威性。
4. 如果要查询的域名，不由首选DNS服务器区域解析，但是缓存了映射关系，则直接使用映射IP返回，不具有权威性
5. 如果上述都失效，根据本地DNS服务器设置的转发器进行查询，如果未使用转发模式，本地DNS把请求发送到13台根DNS，根DNS服务器收到后判断域名由谁管理，并返回一个负责该顶级域名服务器的一个IP，本地DNS服务器收到IP后，联系这台服务器。这台负责`.com`域名的服务器，如果自己解析不了，就找一个管理com的下一级DNS服务器给本地DNS服务器，当本地DNS服务器收到这个地址后，重复上述动作，知道找到对应域名的主机。
6. 如果设置了转发模式，此DNS服务器把请求转发到上一级DNS服务器，由上一级服务器进行解析，如果上一级解析不了，依次转发，最后把结果返回给首选DNS服务器，最后由首选DNS服务器将IP返回给客户端。